<!DOCTYPE HTML>
<html>
  <head>

    <meta http-equiv="Content-Type" content="text/html; charset=utf-8">

    <title>Under Construction - The Classic Web</title>

    <link rel="icon" href="images/icon.ico" type="image/x-icon">

    <link rel="stylesheet" type="text/css" href="CSS/index.css">

  </head>

  <body>

    <!-- Under Construction Banner -->
    <div style="text-align: center; background-color: #ffcc00; color: black; font-family: 'Comic Sans MS', sans-serif; font-size: 24px; padding: 10px; border: 3px solid #000080; margin-bottom: 20px;">
      üöß This Page is Under Construction! üöß
    </div>

    <table class="layout">

      <!-- Header -->
      <tr>
        <td colspan="2">
          <center class="header">WELCOME TO THE CLASSIC WEB</center>
          <div class="navbar">
            <a href="index.html">Home</a>
            <a href="Construction.html">About</a>
            <a href="blog.html">Blog</a>
            <a href="Construction.html">Forms</a>
            <a href="contact.html">Contact</a>
          </div>
        </td>
      </tr>

      <tr>
        <!-- Left Side -->
        <td class="content">
          <div class="box">
            <h2 style="text-align: center;">We're Working on It!</h2>
            <p style="text-align: center;">This page is currently under construction. Please check back later for updates!</p>
            <p style="text-align: center;">In the mean time you can listen to some thunes from the music player.</p>
          </div>
        </td>

        <!-- Right Side -->
        <td valign="top">
          <div id="MusicPlayer">

            <div style="text-align: center; margin: 20px 0;">
                <img src="images/player.gif" alt="Old Media Player" style="width: 320px; height: auto; border: 3px solid #00ffff; background-color: #111111; padding: 10px; display: block; margin: 0 auto;">
              </div>
                
              <center>
                <div>
                  <div style="margin-bottom: 10px;">
                    <button id="shuffleButton" onclick="toggleShuffle()" style="margin: 0; padding: 10px; font-size: 16px; cursor: pointer; background-color: #111111; color: #00ff00; border: 2px solid #00ffff; font-family: 'Arial', sans-serif; margin-right: 10px;">
                        üîÄ On
                    </button>
                    <select id="playlistSelector" onchange="changePlaylist()" style="margin: 0; padding: 10px; font-size: 16px; background-color: #111111; color: #00ff00; border: 2px solid #00ffff; font-family: 'Arial', sans-serif;"></select>
                    <button id="muteButton" onclick="toggleMute()" style="margin-left: 10px; padding: 10px; font-size: 16px; cursor: pointer; background-color: #111111; color: #00ff00; border: 2px solid #00ffff; font-family: 'Arial', sans-serif;">
                      üîä
                    </button>
                  </div>

                  <div style="margin-bottom: 10px;">
                    <button id="prevButton" onclick="playPreviousSong()" style="padding: 10px 15px; font-size: 16px; cursor: pointer; background-color: #111111; color: #00ff00; border: 2px solid #00ffff; font-family: 'Arial', sans-serif; margin-right: 10px;">
                      ‚èÆ
                    </button>
                    <button id="playPauseButton" onclick="toggleMusic()" style="padding: 10px 15px; font-size: 16px; cursor: pointer; background-color: #111111; color: #00ff00; border: 2px solid #00ffff; font-family: 'Arial', sans-serif; margin-right: 10px;">
                      ‚ñ∂
                    </button>
                    <button id="nextButton" onclick="playNextSong()" style="padding: 10px 15px; font-size: 16px; cursor: pointer; background-color: #111111; color: #00ff00; border: 2px solid #00ffff; font-family: 'Arial', sans-serif;">
                      ‚è≠
                    </button>
                  </div>
                </div>
              </center>
                
              <audio id="music" style="display: none;">
                Your browser does not support the audio element.
              </audio>
                
              <script>
                document.addEventListener("DOMContentLoaded", function () {
                  const basePath = "audio/Music/";
                  const playlists = {};
                  let currentPlaylist = null;
                  let playlist = [];
                  let currentSongIndex = 0;
                  const audio = document.getElementById("music");
                  let isShuffleEnabled = true; // Shuffle is enabled by default
                  let shuffleQueue = []; // Queue for shuffle mode
                  let isPlaying = false;
              
                  // Fetch the playlist data from the JSON file
                  fetch("Music.json")
                    .then((response) => response.json())
                    .then((folders) => {
                      // Dynamically generate playlists based on the folder and file structure
                      Object.keys(folders).forEach((folder) => {
                        const folderPath = `${basePath}${folder}/`;
                        playlists[folder] = folders[folder].map((file) => folderPath + file);
                      });
              
                      // Ensure at least one playlist exists
                      if (Object.keys(playlists).length === 0) {
                        console.error("No playlists found. Please add folders and songs.");
                        return;
                      }
              
                      // Set the default playlist
                      currentPlaylist = Object.keys(playlists)[0];
                      playlist = playlists[currentPlaylist];
              
                      // Populate the playlist selector dropdown
                      const selector = document.getElementById("playlistSelector");
                      Object.keys(playlists).forEach((folder) => {
                        const option = document.createElement("option");
                        option.value = folder;
                        option.textContent = folder;
                        selector.appendChild(option);
                      });
              
                      // Shuffle the playlist into the shuffle queue
                      function shufflePlaylist() {
                        if (!playlist || playlist.length === 0) {
                          console.warn("Cannot shuffle an empty playlist.");
                          return;
                        }
              
                        shuffleQueue = [...playlist];
                        for (let i = shuffleQueue.length - 1; i > 0; i--) {
                          const j = Math.floor(Math.random() * (i + 1));
                          [shuffleQueue[i], shuffleQueue[j]] = [shuffleQueue[j], shuffleQueue[i]];
                        }
                      }
              
                      // Change the playlist
                      window.changePlaylist = function () {
                        const selector = document.getElementById("playlistSelector");
                        currentPlaylist = selector.value;
                        playlist = playlists[currentPlaylist];
                        currentSongIndex = 0;
                        shufflePlaylist(); // Reshuffle the new playlist
                        playSong(); // Start playing the first song in the new playlist
                      };
              
                      // Play the current song
                      function playSong() {
                        if (!playlist || playlist.length === 0) {
                          console.error("No songs available in the playlist.");
                          return;
                        }
              
                        if (isShuffleEnabled && shuffleQueue.length > 0) {
                          audio.src = shuffleQueue.shift(); // Get the next song from the shuffle queue
                          if (shuffleQueue.length === 0) {
                            shufflePlaylist(); // Reshuffle when the queue is empty
                          }
                        } else {
                          audio.src = playlist[currentSongIndex];
                        }
              
                        audio.play().catch((err) => {
                          console.error("Error playing audio:", err);
                        });
                      }
              
                      // Play the previous song
                      window.playPreviousSong = function () {
                        if (!playlist || playlist.length === 0) {
                          console.error("No songs available in the playlist.");
                          return;
                        }
              
                        currentSongIndex = (currentSongIndex - 1 + playlist.length) % playlist.length;
                        playSong();
                      };
              
                      // Play or pause the music
                      window.toggleMusic = function () {
                        if (!playlist || playlist.length === 0) {
                          console.error("No songs available in the playlist.");
                          return;
                        }
              
                        if (isPlaying) {
                          // Pause the music
                          audio.pause();
                          document.getElementById("playPauseButton").innerText = "‚ñ∂";
                        } else {
                          // Resume or start the music
                          audio.play().then(() => {
                            document.getElementById("playPauseButton").innerText = "‚è∏";
                          }).catch((err) => {
                            console.error("Error playing audio:", err);
                          });
                        }
                        isPlaying = !isPlaying;
                      };
              
                      // Play the next song
                      window.playNextSong = function () {
                        if (!playlist || playlist.length === 0) {
                          console.error("No songs available in the playlist.");
                          return;
                        }
              
                        if (isShuffleEnabled) {
                          playSong();
                        } else {
                          currentSongIndex = (currentSongIndex + 1) % playlist.length;
                          playSong();
                        }
                      };
              
                      // Mute or unmute the music
                      let isMuted = false;
                      window.toggleMute = function () {
                        audio.muted = !isMuted;
                        document.getElementById("muteButton").innerText = isMuted ? "üîä" : "üîá";
                        isMuted = !isMuted;
                      };
              
                      // Shuffle mode
                      window.toggleShuffle = function () {
                        isShuffleEnabled = !isShuffleEnabled;
                        document.getElementById("shuffleButton").innerText = isShuffleEnabled ? "üîÄ On" : "üîÄ Off";
                        if (isShuffleEnabled) {
                          shufflePlaylist(); // Start the shuffle queue when shuffle is enabled
                        }
                      };
              
                      // Automatically play the next song when the current one ends
                      audio.addEventListener("ended", function () {
                        window.playNextSong();
                      });
              
                      // Update the play/pause button state when the audio is paused or played
                      audio.addEventListener("play", function () {
                        isPlaying = true;
                        document.getElementById("playPauseButton").innerText = "‚è∏";
                      });
              
                      audio.addEventListener("pause", function () {
                        isPlaying = false;
                        document.getElementById("playPauseButton").innerText = "‚ñ∂";
                      });
              
                      // Set shuffle mode on by default
                      document.getElementById("shuffleButton").innerText = "üîÄOn";
                      shufflePlaylist(); // Shuffle the playlist initially
              
                      // Autoplay the first song when the page loads
                      playSong();
                    })
                    .catch((err) => {
                      console.error("Error loading playlists:", err);
                    });
                });
              </script>
          </div>
        </td>
      </tr>

      <!-- Footer -->
      <tr>
        <td colspan="2">
          <div class="footer" style="text-align: center; background-color: #000080; color: white; padding: 10px; font-family: 'Comic Sans MS', sans-serif;">
            üöß Thank you for your patience while we build something amazing! üöß
          </div>
        </td>
      </tr>

      <!-- Marquee -->
      <tr>
        <td class="marquee" colspan="2">
          <marquee behavior="scroll" direction="left" scrollamount="8">
           This is The Classic Web! Enjoy the nostalgia and the vibes of the 90s internet!
          </marquee>
        </td>
      </tr>

    </table>

    <div id="connectionIndicator" style="position: fixed; bottom: 0px; right: -10px; width: 120px; height: auto; z-index: 9999;">
      <img src="images/Connection.gif" alt="Connecting..." style="width: 100%; height: auto; padding: 0px;">
    </div>

  </body>
</html>
